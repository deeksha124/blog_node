"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("express"),t=e(require("pluralize")),i=e(require("express-list-routes")),o=e(require("lodash.camelcase"));function n(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof r?r:r+""}var a=function(e){return"/"===e?"":e.replace(/^(\/+)(.)/,"$2").replace(/(.)(\/+)$/,"$1")},u=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.map(a).filter(Boolean).join("/")},s=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return o(r.filter(Boolean).map((function(e){return e.trim()})).join(" "))},f={index:{method:"get",suffix:!1},show:{method:"get",suffix:!0},store:{method:"post",suffix:!1},update:{method:"put",suffix:!0},patch:{method:"patch",suffix:!0},destroy:{method:"delete",suffix:!0}};exports.default=function(){function e(e,t,i){void 0===e&&(e=""),void 0===t&&(t=r.Router()),void 0===i&&(i=[]),this.head=void 0,this.router=void 0,this.middlewares=void 0,this.head=e,this.router=t,this.middlewares=i}var o,a,l=e.prototype;return l.getRouter=function(){return this.router},l.listRoutes=function(){return i(this.router,{logger:!1})},l.group=function(){for(var r=arguments.length,t=new Array(r),i=0;i<r;i++)t[i]=arguments[i];var o=this.parseGroupArgs(t),n=o.middlewares,a=o.register,s=o.prefix,f=void 0===s?"":s,l=u(this.head,f),d=new e(l,this.router,[].concat(this.middlewares,n)),c=this.createProxy(this.router,d);return a(c),this},l.resource=function(e){var r=this,i=e,o={},n={},a=this.head.split("/"),u=a.pop()||"";return"handlers"in e&&(i=e.handlers,u=e.path||"",o=e.middlewares||{},n=e.parameters||{}),Object.entries(f).forEach((function(e){var f=e[0],l=e[1];if(Reflect.has(i,f)){var d=(o||{})[f],c=void 0===d?[]:d,p=u.split(".").filter(Boolean).reduce((function(e,r){var i=[t.singular(r),"id"];n[r]&&(i=n[r].split(":"));var o,u=!(o=s.apply(void 0,i))||o.startsWith(":")?o:":"+o;return e.push.apply(e,a.concat([r,u])),e}),[]);l.suffix||p.pop();var h=Reflect.get(r.router,l.method);if("function"!=typeof h)throw new Error("Invalid method");var v=i[f];if("function"!=typeof v)throw new Error("Handler is not a function");h.bind(r.router).apply(void 0,[p.join("/")].concat(r.middlewares,[c,v.bind(i)]))}})),this},l.callRouter=function(e){var r=this;return"function"==typeof e?function(t){for(var i=e.bind(r.router),o=u(r.head,t),n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];i.apply(void 0,[o].concat(r.middlewares,a))}:this.router[e]},l.createProxy=function(e,r){var t=this.callRouter.bind(r);return new Proxy(this,{get:function(i,o){return Reflect.has(r,o)?Reflect.get(r,o):t(e[o])}})},l.parseGroupArgs=function(e){switch(typeof e[0]){case"string":var r=e.pop();return{prefix:e[0],register:r,middlewares:e.slice(1)};case"function":return{register:e.pop(),middlewares:e};default:throw new Error("invalid group parameters")}},o=e,(a=[{key:"path",get:function(){return this.head}}])&&function(e,r){for(var t=0;t<r.length;t++){var i=r[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}(o.prototype,a),Object.defineProperty(o,"prototype",{writable:!1}),o}();
//# sourceMappingURL=express-route-grouping.cjs.production.min.js.map
